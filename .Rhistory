for (element in elemental_columns) {
# Data frame for 2010 for the current element
element_2010 <- final_values[final_values$Year == 2010, c("Genotype", element)]
# Data frame for 2011 for the current element
element_2011 <- final_values[final_values$Year == 2011, c("Genotype", element)]
# Merge the data frames by Genotype
merged_df <- merge(element_2010, element_2011, by = "Genotype", suffixes = c("_2010", "_2011"))
# Store the merged data frame in the list
element_year_dfs[[element]] <- merged_df
}
element_df <- element_year_dfs[["Mg25"]]  # Replace "B11" with the desired element name
# Create scatter plot
ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011, color = Genotype)) +
geom_point() +
labs(x = "2010", y = "2011", color = "Genotype") +
ggtitle("Scatter Plot of Mg25 (2010) vs Mg25 (2011) by Genotype")
element_df <- element_year_dfs[["Cd111"]]  # Replace "B11" with the desired element name
# Create scatter plot
ggplot(element_df, aes(x = Cd111_2010, y = Cd111_2011, color = Genotype)) +
geom_point() +
labs(x = "2010", y = "2011", color = "Genotype") +
ggtitle("Scatter Plot of Cd111 (2010) vs Cd111 (2011) by Genotype")
View(element_2010)
plot(pressure)
Cd111_df2 <- element_year_dfs[["Cd111"]]  # Adjust to the desired element name
Mg25_df1 <- element_year_dfs[["Mg25"]]
Cd111_df2 <- element_year_dfs[["Cd111"]]  # Adjust to the desired element name
# Add a column to each data frame to indicate the element
Mg25_df1$Element <- "Mg25"
Cd111_df2$Element <- "Cd111"
# Combine the data frames
combined_df <- rbind(Mg_df1, Cd111_df2)
# Combine the data frames
combined_df <- rbind(Mg25_df1, Cd111_df2)
Mg25_df1 <- element_year_dfs[["Mg25"]]
Cd111_df2 <- element_year_dfs[["Cd111"]]  # Adjust to the desired element name
# Add a column to each data frame to indicate the element
Mg25_df1$Element <- "Mg25"
Cd111_df2$Element <- "Cd111"
# Combine the data frames
combined_df <- rbind(Mg25_df1, Cd111_df2)
View(Cd111_df2)
View(Mg25_df1)
# Combine the data frames
combined_df <- rbind(Mg25_df1, Cd111_df2)
names(Mg25_df1) <- c("Genotype", "X2010", "X2011")
names(Cd111_df2) <- c("Genotype", "X2010", "X2011")
# Add a column to each data frame to indicate the element
Mg25_df1$Element <- "Mg25"
Cd111_df2$Element <- "Cd111"
# Combine the data frames
combined_df <- rbind(Mg25_df1, Cd111_df2)
# Create scatter plot with facets
scatter_plot <- ggplot(combined_df, aes(x = X2010, y = X2011, color = Genotype)) +
geom_point() +
labs(x = "2010", y = "2011", color = "Genotype") +
facet_wrap(~ Element, scales = "free") +
ggtitle("Scatter Plot of 2010 vs 2011 by Element and Genotype")
# Print or display the scatter plot
print(scatter_plot)
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011, color = Genotype)) +
geom_point() +
labs(x = "2010", y = "2011", color = "Genotype") +
ggtitle("Scatter Plot of Mg25 (2010) vs Mg25 (2011) by Genotype")
# Save the scatter plot to a file (e.g., "scatter_plot.png")
ggsave("Mg25_scatter_plot.png", plot = Mg25_scatter_plot, width = 8, height = 6, units = "in", dpi = 300)
View(Mg25_df1)
element_df <- element_year_dfs[["Mg25"]]  # Replace "B11" with the desired element name
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011, color = Genotype)) +
geom_point() +
labs(x = "2010", y = "2011", color = "Genotype") +
ggtitle("Scatter Plot of Mg25 (2010) vs Mg25 (2011) by Genotype")
# Save the scatter plot to a file (e.g., "scatter_plot.png")
ggsave("Mg25_scatter_plot.png", plot = Mg25_scatter_plot, width = 8, height = 6, units = "in", dpi = 300)
View(element_2010)
View(element_year_dfs)
element_df <- element_year_dfs[["Mg25"]]  # Replace "B11" with the desired element name
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011, color = Genotype)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25")
View(Mg25_scatter_plot)
print(Mg25_scatter_plot)
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25")
print(Mg25_scatter_plot)
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25", h = 0.5)
print(Mg25_scatter_plot)
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25", hjust = 0.5)
print(Mg25_scatter_plot)
element_df <- element_year_dfs[["Mg25"]]  # Replace "B11" with the desired element name
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25", hjust = 0.5)
# Create scatter plot
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5))
print(Mg25_scatter_plot)
element_df <- element_year_dfs[["Mg25"]]
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5))
print(Mg25_scatter_plot)
ggsave("Mg25_scatter_plot_remake.png", plot = Mg25_scatter_plot, width = 8, height = 6, units = "in", dpi = 300)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = "white", plot.background = "white")
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), plot.background = element_rect(fill = "white"))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), plot.background = element_rect(fill = "white"))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, size = 1))
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(size = 12), axis.title = element_text(size = 14))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14))
print(Mg25_scatter_plot)
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14))
ggsave("Mg25_scatter_plot_remake.png", plot = Mg25_scatter_plot, width = 8, height = 6, units = "in", dpi = 300)
element_df <- element_year_dfs[["Mg25"]]
combined_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Mg25")
element_df <- element_year_dfs[["Cd111"]]
combined_plot <- combined_plot(element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Cd111")
combined_plot <- combined_plot +
geom_point(data = element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Cd111")
print(combined_plot)
element_df <- element_year_dfs[["Mg25"]]
combined_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Mg25", ncol = 2)
element_df <- element_year_dfs[["Cd111"]]
combined_plot <- combined_plot +
geom_point(data = element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Cd111", ncol = 2)
print(combined_plot)
combined_plot <- combined_plot +
geom_point(data = element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Cd111", ncol = 2)
print(combined_plot)
element_df <- element_year_dfs[["Mg25"]]
combined_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Mg25", ncol = 2)
element_df <- element_year_dfs[["Cd111"]]
combined_plot <- combined_plot +
geom_point(data = element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Cd111", ncol = 2)
print(combined_plot)
library(gridExtra)
element_df <- element_year_dfs[["Mg25"]]
Mg25_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14)) +
facet_wrap(~ "Mg25", ncol = 2)
element_df <- element_year_dfs[["Mg25"]]
Mg25_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14))
element_df <- element_year_dfs[["Cd111"]]
Cd111_plot <- combined_plot +
geom_point(data = element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14))
combined_plot <- grid.arrange(Mg25_plot, Cd111_plot, ncol = 2)
Cd111_plot <- ggplot(element_df, aes(x = Cd111_2010, y = Cd111_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Cd111") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14))
combined_plot <- grid.arrange(Mg25_plot, Cd111_plot, ncol = 2)
library(dplyr)
library(ggplot2)
library(gridExtra)
selected_data <- select(full.data, 3:22, 26, 27) # Select only the data necessary to generate the scatter plots
head(selected_data)
mean_values <- selected_data %>% # Create new data frame with mean values from all the data in the selected data frame
group_by(Genotype, Year) %>% # Group the selected data by genotype and year
summarise(across(where(is.numeric), mean, na.rm = TRUE)) # Calculate the mean values for each element based on the genotype and year
View(mean_values)
mean_values <- selected_data %>% # Create new data frame with mean values from all the data in the selected data frame
group_by(Genotype, Year) %>% # Group the selected data by genotype and year
summarise.groups(across(where(is.numeric), mean, na.rm = TRUE)) # Calculate the mean values for each element based on the genotype and year
mean_values <- selected_data %>% # Create new data frame with mean values from all the data in the selected data frame
group_by(Genotype, Year) %>% # Group the selected data by genotype and year
summarise(across(where(is.numeric), mean, na.rm = TRUE)) # Calculate the mean values for each element based on the genotype and year
genotypes_to_remove <- c("IL14H", "HP301", "P39") # Create a vector of genotypes to remove
final_values <- mean_values %>% # Assign filtered data to a new data frame
filter(!Genotype %in% genotypes_to_remove) # Filter mean_values data frame by every genotype that is not in the genotypes_to_remove vector
elemental_columns <- colnames(final_values)[3:length(final_values)] # Create a vector of elemental isotope names
element_year_dfs <- list() # Create an empty list to store all the elemental data frames
for (element in elemental_columns) { # Loop through the elements in the elemental_columns vector
element_2010 <- final_values[final_values$Year == 2010, c("Genotype", element)] #
element_2011 <- final_values[final_values$Year == 2011, c("Genotype", element)]
merged_df <- merge(element_2010, element_2011, by = "Genotype", suffixes = c("_2010", "_2011"))
element_year_dfs[[element]] <- merged_df
}
element_df <- element_year_dfs[["Mg25"]]
Mg25_scatter_plot <- ggplot(element_df, aes(x = Mg25_2010, y = Mg25_2011)) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle("Mg25") +
theme(plot.title = element_text(hjust = 0.5), panel.background = element_rect(fill = "white"), panel.border = element_rect(color = "black", fill = NA, linewidth = 1), axis.text = element_text(color = "black", size = 12), axis.title = element_text(color = "black", size = 14))
print(Mg25_scatter_plot)
print(Cd111_plot)
Mg25_Cd111_combined_plot <- grid.arrange(Mg25_plot, Cd111_plot, ncol = 2,)
Mg25_Cd111_combined_plot <- grid.arrange(Mg25_plot, Cd111_plot, ncol = 2)
print(Mg25_Cd111_combined_plot)
ggsave("Figure1.png", plot = Mg25_Cd111_combined_plot, width = 8, height = 6, units = "in", dpi = 300)
scatter_plots <- list()
# Loop through each element data frame and create a scatter plot
for (element_name in names(element_year_dfs)) {
element_df <- element_year_dfs[[element_name]]
# Create scatter plot for the current element
scatter_plot <- ggplot(element_df, aes(x = paste0(element_name, "_2010"), y = paste0(element_name, "_2011"))) +
geom_point(size = 3) +
labs(x = paste0(element_name, " (2010)"), y = paste0(element_name, " (2011)")) +
ggtitle(paste("Scatter Plot of", element_name)) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14))
# Store the scatter plot in the list
scatter_plots[[element_name]] <- scatter_plot
}
View(scatter_plots)
scatter_plots_gg <- lapply(scatter_plots, as.ggplot)
# Arrange all scatter plots using grid.arrange
grid.arrange(grobs = scatter_plots, ncol = 4)
View(scatter_plots)
View(scatter_plot)
View(scatter_plots)
# Arrange all scatter plots using grid.arrange
scatter_plots_grob <- lapply(scatter_plots, ggplotGrob)
grid.arrange(grobs = scatter_plots_grob, ncol = 4)
scatter_plots <- list()
# Loop through each element data frame and create a scatter plot
for (element_name in names(element_year_dfs)) {
element_df <- element_year_dfs[[element_name]]
# Create scatter plot for the current element
scatter_plot <- ggplot(element_df, aes(x = paste0(element_name, "_2010"), y = paste0(element_name, "_2011"))) +
geom_point(size = 3) +
labs(x = paste0(element_name, " (2010)"), y = paste0(element_name, " (2011)")) +
ggtitle(paste("Scatter Plot of", element_name)) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, size = 1),
axis.text = element_text(size = 12),
axis.title = element_text(size = 14))
# Store the scatter plot in the list
scatter_plots[[element_name]] <- scatter_plot
}
# Arrange all scatter plots using grid.arrange
scatter_plots_grob <- lapply(scatter_plots, ggplotGrob)
grid.arrange(grobs = scatter_plots_grob, ncol = 4)
# Loop through each element data frame and create a scatter plot
for (element_name in names(element_year_dfs)) {
element_df <- element_year_dfs[[element_name]]
}
View(element_df)
View(element_year_dfs)
# Loop through each element data frame and create a scatter plot
for (name in names(element_year_dfs)) {
element_df <- element_year_dfs[name]
}
View(element_df)
View(element_year_dfs)
View(element_df)
# Loop through each element data frame and create a scatter plot
for (name in names(element_year_dfs)) {
element_df <- element_year_dfs[[name]]
}
# Loop through each element data frame and create a scatter plot
for (name in Names(element_year_dfs)) {
element_df <- element_year_dfs[[name]]
}
for i in names(element_year_dfs) {
for (i in names(element_year_dfs)) {
paste(i, "_df") <- element_year_dfs[[i]]
}
for (i in names(element_year_dfs)) {
i_df <- element_year_dfs[[i]]
}
View(i_df)
View(element_year_dfs)
View(element_year_dfs)
# Loop through each element in the data frame
for (element_name in names(element_year_dfs)) {
# Get the data frame for the current element
element_df <- element_year_dfs[[element_name]]
# Create a scatter plot for the current element
plot <- ggplot(element_df, aes(x = get(paste0(element_name, "_2010")), y = get(paste0(element_name, "_2011")))) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle(element_name) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
axis.text = element_text(color = "black", size = 12),
axis.title = element_text(color = "black", size = 14))
# Store the plot in the list
scatter_plots[[element_name]] <- plot
}
View(plot)
View(scatter_plots)
scatter_plots <- list()
# Loop through each element in the data frame
for (element_name in names(element_year_dfs)) {
# Get the data frame for the current element
element_df <- element_year_dfs[[element_name]]
# Create a scatter plot for the current element
plot <- ggplot(element_df, aes(x = get(paste0(element_name, "_2010")), y = get(paste0(element_name, "_2011")))) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle(element_name) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
axis.text = element_text(color = "black", size = 12),
axis.title = element_text(color = "black", size = 14))
# Store the plot in the list
scatter_plots[[element_name]] <- plot
}
View(scatter_plots)
plots_grobs <- lapply(scatter_plots, ggplotGrob)
# Arrange all plots in a matrix using grid.arrange
grid.arrange(grobs = plots_grobs, ncol = 4)
scatter_plots <- list()
# Loop through each element in the data frame
for (element_name in names(element_year_dfs)) {
# Get the data frame for the current element
element_df <- element_year_dfs[[element_name]]
# Create a scatter plot for the current element
plot <- ggplot(element_df, aes(x = get(paste0(element_name, "_2010")), y = get(paste0(element_name, "_2011")))) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle(element_name) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
axis.text = element_text(color = "black", size = 12),
axis.title = element_text(color = "black", size = 14))
# Store the plot in the list
scatter_plots[[element_name]] <- plot
}
View(scatter_plots)
plots_grobs <- lapply(scatter_plots, ggplotGrob)
View(element_year_dfs)
rlang::last_trace()
scatter_plots <- list()
# Loop through each element in the data frame
for (element_name in names(element_year_dfs)) {
# Get the data frame for the current element
element_df <- element_year_dfs[[element_name]]
# Extract column names for 2010 and 2011
col_2010 <- paste0(element_name, "_2010")
col_2011 <- paste0(element_name, "_2011")
# Create a scatter plot for the current element
plot <- ggplot(element_df, aes(x = !!sym(col_2010), y = !!sym(col_2011))) +
geom_point(size = 3) +
labs(x = "2010", y = "2011") +
ggtitle(element_name) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
axis.text = element_text(color = "black", size = 12),
axis.title = element_text(color = "black", size = 14))
# Store the plot in the list
scatter_plots[[element_name]] <- plot
}
# Convert the list of plots to a list of grobs (graphical objects)
plots_grobs <- lapply(scatter_plots, ggplotGrob)
# Arrange all plots in a matrix using grid.arrange
grid.arrange(grobs = plots_grobs, ncol = 3)
# Arrange all plots in a matrix using grid.arrange
grid.arrange(grobs = plots_grobs, ncol = 4)
# Arrange all plots in a matrix using grid.arrange
all_elements_plot <- grid.arrange(grobs = plots_grobs, ncol = 4)
ggsave("all_elements_plot.png", plot = all_elements_plot, width = 8, height = 6, units = "in", dpi = 300)
# Loop through each element in the data frame
for (element_name in names(element_year_dfs)) {
# Get the data frame for the current element
element_df <- element_year_dfs[[element_name]]
# Extract column names for 2010 and 2011
col_2010 <- paste0(element_name, "_2010")
col_2011 <- paste0(element_name, "_2011")
# Create a scatter plot for the current element
plot <- ggplot(element_df, aes(x = !!sym(col_2010), y = !!sym(col_2011)), height = 6) +
geom_point(size = 1) +
labs(x = "2010", y = "2011") +
ggtitle(element_name) +
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white"),
panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
axis.text = element_text(color = "black", size = 12),
axis.title = element_text(color = "black", size = 14))
# Store the plot in the list
scatter_plots[[element_name]] <- plot
}
# Convert the list of plots to a list of grobs (graphical objects)
plots_grobs <- lapply(scatter_plots, ggplotGrob)
# Arrange all plots in a matrix using grid.arrange
all_elements_plot <- grid.arrange(grobs = plots_grobs, ncol = 4)
ggsave("all_elements_plot.png", plot = all_elements_plot, width = 8, height = 6, units = "in", dpi = 300)
ggsave("all_elements_plot.png", plot = all_elements_plot, width = 10, height = 10, units = "in", dpi = 300)
ggsave("all_elements_plot.png", plot = all_elements_plot, width = 12, height = 10, units = "in", dpi = 300)
